@page "/LandingPage"
@using TechReviewzWebsite.Components.Account.Shared
@rendermode InteractiveServer

<PageTitle>Landing Page</PageTitle>

<div>
    <div class="panel1">
        <div>
            <img src="./Images/devices_background.jpg" class="panel1_img" />
        </div>
        <div class="panel1_2">
            <div class="panel1_txt">
                <h1><b>Welcome to TechReviewz!</b></h1>
                <p>Your ultimate destination for honest and in-depth tech product reviews.</p>
            </div>
        </div>
    </div>

    <div class="panel2">
        <div class="panel2_txt">
            <h1><b>Why choose us?</b></h1>
        </div>
    </div>

    <div class="panel3">
        <div class="panel3_txt">
            <h1><b>People doing the reviews</b></h1>
        </div>
    </div>

    <div>
        @* show status messages for the newsletter subscription *@
        <StatusMessage Message="@NewsletterStatus" />

        <div class="panel4_1">
            <div class="panel4_1_txt">
                <h1><b>Subscribe to our Newsletter!</b></h1>

                <div class="spacing">
                    <label for="email">Email</label>
                    <input id="email" class="form-control" type="email" placeholder="you@example.com" @bind="NewsletterEmail" />
                </div>

                <div class="spacing">
                    <button class="btn btn-primary" @onclick="SubscribeAsync" disabled="@IsSubmitting">
                        @(IsSubmitting ? "Signing up…" : "Sign up")
                    </button>
                    @* <ValidationMessage class="text-danger" /> *@
                </div>
            </div>
        </div>

        <div class="panel4_2">
            <div>
                <img src="./Images/newsletter_img.jpg" class="panel4_img" />
            </div>
        </div>
    </div>

    <div class="panel5">
        <div class="panel5_txt">
            <div>
                <a href="/AboutUs" class="spacing2">About us</a>
                <a href="/ContactUs" class="spacing2">Contact us</a>
                <a href="/FAQ" class="spacing2">FAQ</a>
                <a href="/Copyright" class="spacing2">Terms and Conditions</a>
            </div>

            <div class="spacing2">
                <h1><b>Find out more about us at...</b></h1>
            </div>

            @* <svg>Add image here</svg> *@
        </div>
    </div>

    <div class="panel6">
        <div class="panel6_txt">
            <p>TechReviewz 2025. All rights reserved.</p>
        </div>
    </div>
</div>

@code {
    private string? NewsletterEmail;
    private string? NewsletterStatus;
    private bool IsSubmitting;

    // Minimal client-side feedback. Replace the simulated call with your real subscribe API call.
    private async Task SubscribeAsync()
    {
        NewsletterStatus = null;
        if (string.IsNullOrWhiteSpace(NewsletterEmail))
        {
            NewsletterStatus = "Error: Please enter a valid email.";
            return;
        }

        try
        {
            IsSubmitting = true;

            // TODO: call your API or service to persist the subscription and send confirmation email.
            // Example (uncomment and adapt if you have an API):
            // var resp = await Http.PostAsJsonAsync("/api/newsletter/subscribe", new { Email = NewsletterEmail });
            // if (!resp.IsSuccessStatusCode) throw new Exception("Subscription failed");

            // simulate async work
            await Task.Delay(300);

            NewsletterStatus = "Confirmation email sent. Please check your inbox.";
            NewsletterEmail = null; // clear input on success
        }
        catch (Exception ex)
        {
            NewsletterStatus = "Error: Subscription failed. Try again later.";
            Console.Error.WriteLine(ex);
        }
        finally
        {
            IsSubmitting = false;
        }
    }
}


