@page "/StaffHome"
@using Microsoft.EntityFrameworkCore
@using TechReviewzWebsite.Data
@using TechReviewzWebsite.Domain
@inject TechReviewzWebsiteContext _context

<PageTitle>Staff Dashboard</PageTitle>
<h1>Staff Home</h1>

@if (dashboardStats is null)
{
    <p>Loading stats...</p>
}


else
{
    <div class="dash-grid">
        <div class="stat-card">
            <div class="label">Total Users</div>
            <div class="value">@dashboardStats.TotalUsers</div>
        </div>

        <div class="stat-card">
            <div class="label">Total Products</div>
            <div class="value">@dashboardStats.TotalProducts</div>
        </div>

        <div class="stat-card">
            <div class="label">Total Reviews</div>
            <div class="value">@dashboardStats.TotalReviews</div>
        </div>

        <div class="stat-card">
            <div class="label">Total Comments</div>
            <div class="value">@dashboardStats.TotalComments</div>
        </div>
    </div>
}

<section>
    <div>
        <div class="card chart-card wide">
            <div class="card-title">Pending reviews</div>
            <div class="placeholder"></div>
        </div>
    </div>
</section>

<div class="panel">
    <h2 class="panel-title">Add Products</h2>
    <a href="/reviews">Add product</a>
</div>





@code {
    private StaffDashboardStats? dashboardStats;

    protected override async Task OnInitializedAsync()
    {
        var totalComments = await _context.Comments.CountAsync();
        var totalUsers = await _context.Users.CountAsync();
        var totalProducts = await _context.Product.CountAsync();
        var totalReviews = await _context.Review.CountAsync();

        dashboardStats = new StaffDashboardStats
        {
            TotalComments = totalComments,
            TotalUsers = totalUsers,
            TotalProducts = totalProducts,
            TotalReviews = totalReviews
        };
    }
}